---
import BaseLayout from '@layouts/BaseLayout.astro';
import Section from '@components/Section.astro';
import Hero from '@components/Hero.astro';
import Collaborators from '@components/Collaborators.astro';
import ContactForm from '@components/ContactForm.astro';
import ExpertiseGrid from '@components/ExpertiseGrid.astro';
import TeamGrid from '@components/TeamGrid.astro';
import ProjectCard from '@components/ProjectCard.astro';
import { getCollection } from 'astro:content';

const allProjects = await getCollection('projects');
const featured = allProjects.filter((p) => p.data.featured).slice(0, 6);
---
<BaseLayout>
  <Hero />

  <Section id="expertise" title="Expertise">
    <ExpertiseGrid />
  </Section>

  <Section id="team" title="Team">
    {/*
      Only show members that have the new toggle enabled.
      Team page (src/pages/team.astro) still shows everyone.
    */}
    <TeamGrid homeOnly={true} />
  </Section>

  <Section id="projects" title="Featured projects">
    <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
      {featured.map((p) => <ProjectCard project={p} />)}
    </div>
  </Section>

  <Section id="collaborators" title="Collaborators & partners" edge={true}>
    <Collaborators />
  </Section>

  <Section id="contact" title="Contact">
    <ContactForm />
  </Section>
</BaseLayout>
