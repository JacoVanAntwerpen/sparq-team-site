---
import BaseLayout from '@layouts/BaseLayout.astro';
import Section from '@components/Section.astro';
import Hero from '@components/Hero.astro';
import Collaborators from '@components/Collaborators.astro';
import ContactForm from '@components/ContactForm.astro';
import ExpertiseGrid from '@components/ExpertiseGrid.astro';
import TeamGrid from '@components/TeamGrid.astro';

import { getCollection } from 'astro:content';

// Projects: keep your existing featured selection
const allProjects = await getCollection('projects');
const featured = allProjects.filter((p) => p.data.featured).slice(0, 6);
---
<BaseLayout>
  <Hero />

  <Section id="expertise" title="What we do" edge={true}>
    <ExpertiseGrid />
  </Section>

  <Section id="team" title="Team" subtitle="People behind the work.">
    <TeamGrid />
  </Section>

  <Section id="projects" title="Featured projects" subtitle="Representative workâ€”replace with your own.">
    <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
      {featured.map((p) => {
        const img = p.data.tileImage || p.data.heroImage;
        return (
        <a
          href={`/projects/${p.slug}`}
          class="rounded-2xl border border-neutral-200 bg-white shadow-sm hover:shadow-md transition-shadow block overflow-hidden"
        >
          {img && (
            <img src={img} alt={p.data.tileImageAlt || p.data.title} class="h-40 w-full object-cover" loading="lazy" />
          )}
          <div class="p-6">
            <h3 class="font-semibold">{p.data.title}</h3>
            <p class="mt-2 text-sm text-neutral-700">{p.data.shortDescription}</p>
          </div>
        </a>
      )})}
    </div>
  </Section>

  <Section id="collaborators" title="Collaborators & partners" edge={true}>
    <Collaborators />
  </Section>

  <Section id="contact" title="Contact" subtitle="Tell us about your project.">
    <ContactForm />
  </Section>
</BaseLayout>
