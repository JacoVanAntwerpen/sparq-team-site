---
import BaseLayout from '@layouts/BaseLayout.astro';
import Section from '@components/Section.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const entries = await getCollection('resources');
  return entries.map((e) => ({ params: { slug: e.slug }, props: { entry: e } }));
}

const { entry } = Astro.props;
---
<BaseLayout title={`${entry.data.title} — Resources — SPARQ Team`}>
  <Section id="resource" title={entry.data.title} subtitle={entry.data.oneLine}>
    {entry.data.image && (
      <img src={entry.data.image} alt={entry.data.title} class="w-full max-w-3xl rounded-2xl shadow-sm mb-6" loading="eager" />
    )}

    {entry.data.summary && <p class="text-neutral-800">{entry.data.summary}</p>}

    {entry.data.links?.length > 0 && (
      <div class="mt-6">
        <h3 class="font-semibold mb-2">Links</h3>
        <ul class="list-disc pl-5">
          {entry.data.links.map((l) => (
            <li><a class="text-blue-700 underline" href={l.url} target="_blank">{l.label}</a></li>
          ))}
        </ul>
      </div>
    )}

    {entry.data.files?.length > 0 && (
      <div class="mt-6">
        <h3 class="font-semibold mb-2">Downloads</h3>
        <ul class="list-disc pl-5">
          {entry.data.files.map((f) => (
            <li><a class="text-blue-700 underline" href={f.file} download>{f.label}</a></li>
          ))}
        </ul>
      </div>
    )}

    {entry.data.citation && <div class="text-xs text-neutral-500 mt-2">{entry.data.citation}</div>}
  </Section>
</BaseLayout>
