---
import BaseLayout from '@layouts/BaseLayout.astro';
import Section from '@components/Section.astro';
import { getCollection } from 'astro:content';

const resources = await getCollection('resources');

/** Map our tileImageFocus to CSS object-position */
const posMap = {
  center: 'center',
  top: 'center top',
  bottom: 'center bottom',
  left: 'left center',
  right: 'right center',
  'top-left': 'left top',
  'top-right': 'right top',
  'bottom-left': 'left bottom',
  'bottom-right': 'right bottom',
};
const focusToPos = (focus = 'center') => posMap[focus] || 'center';
---
<BaseLayout title="Tools & Resources — SPARQ Team">
  <Section id="tools" title="Tools & platforms" subtitle="Link to docs, repos, or hosted apps.">
    <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
      {resources.map((r) => {
        const d = r.data ?? {};
        const img = d.tileImage || d.heroImage || d.image; // tile → hero → fallback
        const objectPosition = focusToPos(d.tileImageFocus || 'center');

        return (
          <a
            href={`/resources/${r.slug}`}
            class="group rounded-2xl border border-neutral-200 bg-white shadow-sm hover:shadow-md transition-shadow block overflow-hidden"
          >
            {img && (
              <div class="aspect-[16/9] w-full overflow-hidden bg-neutral-100">
                <img
                  src={img}
                  alt={d.tileImageAlt || d.title}
                  class="h-full w-full object-cover transition-transform duration-300 group-hover:scale-[1.03]"
                  style={`object-position:${objectPosition};`}
                  loading="lazy"
                />
              </div>
            )}
            <div class="p-6">
              <h3 class="font-semibold">{d.title}</h3>
              {d.oneLine && <p class="mt-2 text-sm text-neutral-700">{d.oneLine}</p>}
              {d.summary && <p class="mt-2 text-sm text-neutral-700">{d.summary}</p>}
            </div>
          </a>
        );
      })}
    </div>
  </Section>
</BaseLayout>
