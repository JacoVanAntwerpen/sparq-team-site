---
import { getCollection } from 'astro:content';
import TeamCard from './TeamCard.astro';

const { limit = undefined, extraClass = '', homeOnly = false } = Astro.props as {
  limit?: number;
  extraClass?: string;
  homeOnly?: boolean;
};

let team = await getCollection('team');

team = team.sort((a, b) => {
  const ao = a.data?.order ?? 9999;
  const bo = b.data?.order ?? 9999;
  if (ao !== bo) return ao - bo;
  return (a.data?.name ?? '').localeCompare(b.data?.name ?? '');
});

if (homeOnly) {
  // Default is true via schema; this preserves current behaviour until you toggle people off.
  team = team.filter((p) => p.data?.showOnHome ?? true);
}

if (typeof limit === 'number') {
  team = team.slice(0, Math.max(0, limit));
}
---
<div class={`grid gap-8 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 ${extraClass ?? ''}`}>
  {team.map((p) => <TeamCard person={p} />)}
</div>
